rule Signed_binary_32bit
{
    meta:
        description = "hacky sensing of possible digitally signed executables (32bits)"
    strings:
        $mz = "MZ"
    condition:
        $mz at 0 and uint32(uint32(0x3c)) == 0x00004550 and 0x010B == uint16(uint32(0x3C) + 0x18) and 0 < uint16(uint32(0x3C)+6) and 0 < uint32(uint32(0x3C)+0x98) and 0 < uint32(uint32(0x3C)+0x9C)
}

rule Signed_binary_64bit
{
    meta:
        description = "hacky sensing of possible digitally signed executables for 64 bits (AMD64 and IA64)"
    strings:
        $mz = "MZ"
    condition:
        $mz at 0 and uint32(uint32(0x3c)) == 0x00004550 and 0x020B == uint16(uint32(0x3C) + 0x18) and 0 < uint16(uint32(0x3C) + 0x06) and 0 < uint32(uint32(0x3C) + 0xA8) and 0 < uint32(uint32(0x3C) + 0xAC)
}

