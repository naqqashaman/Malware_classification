# Malware_classification


The Scripts related to sample collection and labeling are:

vt_download.py
vt_rescan.py
vtresults.py
get_majority_label.py

These scripts are executed in the same sequence as they are given above: 

First vt_download.py is used to download samples from Virustotal

python vt_download.py "type:peexe positives:5+ fs:2016-04-17+ fs:2016-04-24-"

Signed binaries are excluded using yara rules

yara yara_rule_file samples_directory

Samples are rescanned for latest AV signatures available on VirusTotal

python vt_rescan.py hashes_list_of_the downloaded_samples

The malware family and type labels assigned by AV vendors to the sample set are retrieved using another python script named vtresults.py

python vtresults.py <md5list> <outfile.csv> <error_md5s>

The outfile.csv generated by vtresults.py is used to get majority family label using get_majority_label.py

python get_majority_label.py outfile.csv

---------------------------------------------------------------------------------------------------------------------------------

To extract the feature and represent them in a coded csv format create_feature_csv.py and enum.py are used.

python create_feature_csv.py "Path of the directory where Cuckoo reports are present"

---------------------------------------------------------------------------------------------------------------------------------

Other than scripts few files are also added here:

yara_rules_to_filter_signed_binaries.txt  -- Yara rules written to identify signed binaries.

API_features_list.txt -- List of API calls used as features.

Signature_features.docx -- Signature features used for each family.

categories_of_observedapi -- Category wise break down of the API calls used as features.

output_with_api_boolean.csv -- Feature set file which can be utilized by Machine learning classifier.



